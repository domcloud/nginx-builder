diff --git a/bin/passenger-install-nginx-module b/bin/passenger-install-nginx-module
index 08eb1d29..18bc75df 100755
--- a/bin/passenger-install-nginx-module
+++ b/bin/passenger-install-nginx-module
@@ -479,6 +479,7 @@ def install_nginx(source_dir, prefix, extra_configure_flags)
       new_screen
       puts "<banner>Compiling and installing Nginx...</banner>"
       if !sh(build_nginx_configure_command(prefix, extra_configure_flags)) ||
+         !sh("touch ../boringssl/.openssl/include/openssl/ssl.h") ||
          !sh("make") ||
          !sh("make install")
         return false
diff --git a/src/nginx_module/ngx_http_passenger_module.c b/src/nginx_module/ngx_http_passenger_module.c
index 7d40f622..2fa0a662 100644
--- a/src/nginx_module/ngx_http_passenger_module.c
+++ b/src/nginx_module/ngx_http_passenger_module.c
@@ -193,6 +193,29 @@ save_master_process_pid(ngx_cycle_t *cycle) {
     return NGX_OK;
 }
 
+static ngx_int_t
+save_child_process_pid(ngx_cycle_t *cycle) {
+    u_char filename[NGX_MAX_PATH];
+    u_char *last;
+    FILE *f;
+
+    last = ngx_snprintf(filename, sizeof(filename) - 1, "%s/web_server_info/child_process.pid",
+                        psg_watchdog_launcher_get_instance_dir(psg_watchdog_launcher, NULL));
+    *last = (u_char) '\0';
+
+    f = fopen((const char *) filename, "w");
+    if (f != NULL) {
+        fprintf(f, "%ld", (long) getpid());
+        fclose(f);
+    } else {
+        ngx_log_error(NGX_LOG_ALERT, cycle->log, ngx_errno,
+                      "could not create %s", filename);
+    }
+
+    return NGX_OK;
+}
+
+
 typedef struct {
     ngx_cycle_t *cycle;
     int log_fd;
@@ -509,7 +532,6 @@ pre_config_init(ngx_conf_t *cf)
 {
     char *error_message;
 
-    shutdown_watchdog();
 
     ngx_memzero(&passenger_main_conf, sizeof(passenger_main_conf_t));
     pp_schema_string.data = (u_char *) "passenger:";
@@ -567,15 +589,9 @@ init_module(ngx_cycle_t *cycle) {
  */
 static ngx_int_t
 init_worker_process(ngx_cycle_t *cycle) {
-    ngx_core_conf_t *core_conf;
-
     if (passenger_main_conf.autogenerated.root_dir.len != 0 && !ngx_test_config) {
         save_master_process_pid(cycle);
-
-        core_conf = (ngx_core_conf_t *) ngx_get_conf(cycle->conf_ctx, ngx_core_module);
-        if (core_conf->master) {
-            psg_watchdog_launcher_detach(psg_watchdog_launcher);
-        }
+        save_child_process_pid(cycle);
     }
     return NGX_OK;
 }
